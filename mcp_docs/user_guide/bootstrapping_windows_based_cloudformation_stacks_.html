<!-- Source URL: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html -->
<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Bootstrapping Windows-based CloudFormation stacks - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="cfn-windows-stacks-bootstrapping" /><meta name="default_state" content="cfn-windows-stacks-bootstrapping" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" /><meta name="description" content="Use CloudFormation to bootstrap a Windows stack." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><head xmlns="http://www.w3.org/1999/xhtml"> <script defer="" src="/assets/r/awsdocs-doc-page.2.0.0.js"></script><link href="/assets/r/awsdocs-doc-page.2.0.0.css" rel="stylesheet"/></head>
<script defer="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Bootstrapping Windows-based CloudFormation stacks" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Bootstrapping Windows-based CloudFormation stacks - AWS CloudFormation</title><meta name="pdf" content="/pdfs/AWSCloudFormation/latest/UserGuide/cfn-ug.pdf#cfn-windows-stacks-bootstrapping" /><meta name="rss" content="aws-cloudformation-user-guide-updates.rss" /><meta name="forums" content="https://repost.aws/tags/TAm3R3LNU3RfSX9L23YIpo3w" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set,CloudFormation templates,define your infrastructure" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with CloudFormation templates",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Deploy Windows-based stacks using CloudFormation",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Bootstrapping Windows-based CloudFormation stacks",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AWSCloudFormation/latest/UserGuide/cfn-ug.pdf#cfn-windows-stacks-bootstrapping" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#cfn-windows-bootstrapping-user-data">User data in EC2 instances</a><a href="#cfn-windows-bootstrapping-helper-scripts">CloudFormation helper
            scripts</a><a href="#cfn-windows-bootstrapping-example">Example of bootstrapping a
            Windows stack</a><a href="#w48aac11c41c19c15">Manage Windows services</a><a href="#cfn-windows-stacks-troubleshooting">Troubleshoot stack creation
            issues</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="cfn-windows-stacks-bootstrapping">Bootstrapping Windows-based
         CloudFormation stacks</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>This topic describes how to bootstrap a Windows stack and troubleshoot stack
      creation issues. </p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><p><a href="#cfn-windows-bootstrapping-user-data">User data in EC2 instances</a></p></li><li><p><a href="#cfn-windows-bootstrapping-helper-scripts">CloudFormation helper
            scripts</a></p></li><li><p><a href="#cfn-windows-bootstrapping-example">Example of bootstrapping a
            Windows stack</a></p></li><li><p><a href="#w48aac11c41c19c15">Manage Windows services</a></p></li><li><p><a href="#cfn-windows-stacks-troubleshooting">Troubleshoot stack creation
            issues</a></p></li></ul></div>
      <h2 id="cfn-windows-bootstrapping-user-data">User data in EC2 instances</h2>
      <p>User data is an Amazon EC2 feature that allows you to pass scripts or configuration
         information to an EC2 instance when it launches. </p>
      <p>For Windows EC2 instances:</p>
      <div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>User data is executed as batch scripts.</p>
         </li><li class="listitem">
            <p>You can use either batch commands (using <code class="code">&lt;script&gt;</code> tags) or
               PowerShell scripts (using <code class="code">&lt;powershell&gt;</code> tags).</p>
         </li><li class="listitem">
            <p>Script execution is handled by EC2Launch.</p>
         </li></ul></div>
      <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>If you are creating your own Windows AMI for use with CloudFormation, make sure
            that EC2Launch v2 is properly configured. EC2Launch v2 is required for
            CloudFormation bootstrapping tools to properly initialize and configure Windows
            instances during stack creation. For more information, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2launch-v2.html">Use the EC2Launch v2 agent to
               perform tasks during EC2 Windows instance launch</a> in the <em>Amazon EC2 User
               Guide</em>.</p><p>For information about available AWS Windows AMIs, see the <a href="https://docs.aws.amazon.com/ec2/latest/windows-ami-reference/windows-amis.html">AWSÂ Windows AMI Reference</a>.</p></div></div>
    
      <h2 id="cfn-windows-bootstrapping-helper-scripts">CloudFormation helper
            scripts</h2>
      <p>Helper scripts are utilities for configuring instances during the bootstrapping process.
         Used with Amazon EC2 user data, they provide powerful configuration options.</p>
      <p>CloudFormation provides the following Python helper scripts that you can use to install
         software and start services on an Amazon EC2 instance that you create as part of your
         stack:</p>
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>
               <code class="code">cfn-init</code> â Use to retrieve and interpret resource metadata,
               install packages, create files, and start services.</p>
         </li><li class="listitem">
            <p>
               <code class="code">cfn-signal</code> â Use to signal with a <code class="code">CreationPolicy</code> or
                  <code class="code">WaitCondition</code>, so you can synchronize other resources in the stack
               when the prerequisite resource or application is ready.</p>
         </li><li class="listitem">
            <p>
               <code class="code">cfn-get-metadata</code> â Use to retrieve metadata for a resource or
               path to a specific key.</p>
         </li><li class="listitem">
            <p>
               <code class="code">cfn-hup</code> â Use to check for updates to metadata and execute custom
               hooks when changes are detected.</p>
         </li></ul></div>
      <p>You call the scripts directly from your template. The scripts work in conjunction with
         resource metadata that's defined in the same template. The scripts run on the Amazon EC2
         instance during the stack creation process.</p>
      <p>For more information, see the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/cfn-helper-scripts-reference.html">CloudFormation helper scripts reference</a> in the <em>AWS CloudFormation Template
            Reference Guide</em>.</p>
    
      <h2 id="cfn-windows-bootstrapping-example">Example of bootstrapping a
            Windows stack</h2>
      
      <p>Let's examine example snippets from a SharePoint server template that performs the
         following actions:</p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Configures initialization files: <code>cfn-credentials</code>,
                  <code>cfn-hup.conf</code>, and
               <code>cfn-auto-reloader.conf</code>.</p>
         </li><li class="listitem">
            <p>Downloads and installs a package such as SharePoint Foundation on the server
               instance.</p>
         </li><li class="listitem">
            <p>Uses a <code class="code">WaitCondition</code> to ensure resources are ready.</p>
         </li><li class="listitem">
            <p>Creates an IAM user and security group for access to the instance.</p>
         </li><li class="listitem">
            <p>Retrieves an IP for the instance with Amazon Elastic IP (EIP).</p>
         </li></ul></div>
      <p>The <code>cfn-init</code> helper script is used to perform each of these
         actions, based on information in the <code class="code">AWS::CloudFormation::Init</code> resource in the
         template.</p>
      <p>The <code class="code">AWS::CloudFormation::Init</code> section is named
            <code class="code">SharePointFoundation</code> and begins with a standard declaration:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"SharePointFoundation": <span>{</span>
   "Type" : "AWS::EC2::Instance",
   "Metadata" : <span>{</span>
     "AWS::CloudFormation::Init" : <span>{</span>
       "config" : <span>{</span></code></pre>
      <p>After this, the <code class="code">files</code> section of <code class="code">AWS::CloudFormation::Init</code> is
         declared:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"files" : <span>{</span>
  "c:\\cfn\\cfn-hup.conf" : <span>{</span>
    "content" : <span>{</span> "Fn::Join" : ["", [
      "[main]\n",
      "stack=", <span>{</span> "Ref" : "AWS::StackName" }, "\n",
      "region=", <span>{</span> "Ref" : "AWS::Region" }, "\n"
      ]]}
  },
  "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf" : <span>{</span>
    "content": <span>{</span> "Fn::Join" : ["", [
      "[cfn-auto-reloader-hook]\n",
      "triggers=post.update\n",
      "path=Resources.SharePointFoundation.Metadata.AWS::CloudFormation::Init\n",
      "action=cfn-init.exe -v -s ", <span>{</span> "Ref" : "AWS::StackName" },
                                     " -r SharePointFoundation",
                                     " --region ", <span>{</span> "Ref" : "AWS::Region" }, "\n"
    ]]}
  },
  "C:\\SharePoint\\SharePointFoundation2010.exe" : <span>{</span>
    "source" : "http://d3adzpja92utk0.cloudfront.net/SharePointFoundation.exe"
  }
},</code></pre>
      <p>Three files are created here and placed in the <code>C:\cfn</code> directory on
         the server instance. They're:</p>
      <div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><code>cfn-hup.conf</code>, the configuration file for
               <code class="code">cfn-hup</code>.</p>
         </li><li class="listitem">
            <p><code>cfn-auto-reloader.conf</code>, the configuration file for the hook
               used by <code class="code">cfn-hup</code> to initiate an update (calling <code class="code">cfn-init</code>)
               when the metadata in <code class="code">AWS::CloudFormation::Init</code> changes.</p>
         </li></ul></div>
      <p>There is also a file that's downloaded to the server:
            <code>SharePointFoundation.exe</code>. This file is used to install SharePoint
         on the server instance.</p>
      <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Because paths on Windows use a backslash ('\') character, you must always
            remember to properly escape all backslashes by prepending another backslash whenever you
            refer to a Windows path in the CloudFormation template.</p></div></div>
      <p>Next is the <code class="code">commands</code> section, which are <code>cmd.exe</code>
         commands.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"commands" : <span>{</span>
  "1-extract" : <span>{</span>
    "command" : "C:\\SharePoint\\SharePointFoundation2010.exe /extract:C:\\SharePoint\\SPF2010 /quiet /log:C:\\SharePoint\\SharePointFoundation2010-extract.log"
  },
  "2-prereq" : <span>{</span>
    "command" : "C:\\SharePoint\\SPF2010\\PrerequisiteInstaller.exe /unattended"
  },
  "3-install" : <span>{</span>
    "command" : "C:\\SharePoint\\SPF2010\\setup.exe /config C:\\SharePoint\\SPF2010\\Files\\SetupSilent\\config.xml"
  }</code></pre>
      <p>Because commands in the instance are processed in alphabetical order by name, each
         command has been prepended with a number indicating its desired execution order. Thus, we
         can make sure that the installation package is first extracted, all prerequisites are then
         installed, and finally, installation of SharePoint is started.</p>
      <p>Next is the <code class="code">Properties</code> section:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"Properties": <span>{</span>
  "InstanceType" : <span>{</span> "Ref" : "InstanceType" },
  "ImageId" : <span>{</span> "Fn::FindInMap" : [ "AWSRegionArch2AMI", <span>{</span> "Ref" : "AWS::Region" },
                <span>{</span> "Fn::FindInMap" : [ "AWSInstanceType2Arch", <span>{</span> "Ref" : "InstanceType" }, "Arch" ] } ] },
  "SecurityGroups" : [ <span>{</span>"Ref" : "SharePointFoundationSecurityGroup"} ],
  "KeyName" : <span>{</span> "Ref" : "KeyPairName" },
  "UserData" : <span>{</span> "Fn::Base64" : <span>{</span> "Fn::Join" : ["", [
    "&lt;script&gt;\n",

    "cfn-init.exe -v -s ", <span>{</span> "Ref" : "AWS::StackName" },
    " -r SharePointFoundation",
    " --region ", <span>{</span> "Ref" : "AWS::Region" }, "\n",

    "cfn-signal.exe -e %ERRORLEVEL% ", <span>{</span> "Fn::Base64" : <span>{</span> "Ref" : "SharePointFoundationWaitHandle" }}, "\n",

    "&lt;/script&gt;"
    ]]}}
  }</code></pre>
      <p>In this section, the <code class="code">UserData</code> property contains a
            <code>cmd.exe</code> script that will be executed by
            <code>cfn-init</code>, surrounded by <code class="code">&lt;script&gt;</code> tags. You can
         use a Windows PowerShell script here instead by surrounding your script with
            <code class="code">&lt;powershell&gt;</code> tags. For Windows stacks, you must base64 encode
         the wait condition handle URL again.</p>
      <p><code class="code">SharePointFoundationWaitHandle</code> is referenced here and run with
            <code>cfn-signal</code>. The <code class="code">WaitConditionHandle</code> and associated
            <code class="code">WaitCondition</code> are declared next in the template:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"SharePointFoundationWaitHandle" : <span>{</span>
   "Type" : "AWS::CloudFormation::WaitConditionHandle"
},

"SharePointFoundationWaitCondition" : <span>{</span>
   "Type" : "AWS::CloudFormation::WaitCondition",
   "DependsOn" : "SharePointFoundation",
   "Properties" : <span>{</span>
     "Handle" : <span>{</span>"Ref" : "SharePointFoundationWaitHandle"},
     "Timeout" : "3600"
   }
}</code></pre>
      <p>Because executing all the steps and installing SharePoint might take a while, but not an
         entire hour, the <code class="code">WaitCondition</code> waits an hour (3600 seconds) before timing
         out.</p>
      <p>If all goes well, an Elastic IP is used to provide access to the SharePoint
         instance:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"Outputs" : <span>{</span>
 "SharePointFoundationURL" : <span>{</span>
   "Value" : <span>{</span> "Fn::Join" : ["", ["http://", <span>{</span> "Ref" : "SharePointFoundationEIP" } ]] },
   "Description" : "SharePoint Team Site URL. Please retrieve Administrator password of the instance and use it to access the URL"
 }</code></pre>
      <p>Once stack creation is complete, the IP address supplied by EIP will be displayed in the
            <b>Outputs</b> tab of the CloudFormation console. However, before you can
         access the instance you will need to retrieve the generated temporary administrator
         password for the instance. For more information, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/connecting_to_windows_instance.html">Connect to your
            Windows instance using RDP</a> in the
            <em>Amazon EC2 User Guide</em>.</p>
    
      <h2 id="w48aac11c41c19c15">Manage Windows services</h2>

      <p>You manage Windows services in the same way as Linux services, except that you
         use a <code class="code">windows</code> key instead of <code class="code">sysvinit</code>. The following example
         starts the <code class="code">cfn-hup</code> service, sets it to Automatic, and restarts the service if
            <code class="code">cfn-init</code> modifies the <code>c:\cfn\cfn-hup.conf</code> or
            <code>c:\cfn\hooks.d\cfn-auto-reloader.conf</code> configuration files.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"services" : <span>{</span>
  "windows" : <span>{</span>
    "cfn-hup" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["c:\\cfn\\cfn-hup.conf", "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"]
    }
  }
} </code></pre>
      <p>You can manage other Windows services in the same way by using the
         nameânot the display nameâto reference the service.</p>
    
      <h2 id="cfn-windows-stacks-troubleshooting">Troubleshoot stack creation
            issues</h2>

      <p>If your stack fails during creation, the default behavior is to rollback on failure.
         While this is normally a good default because it avoids unnecessary charges, it makes it
         difficult to debug why your stack creation is failing.</p>
      <p>To turn this behavior off when creating or updating your stack with the CloudFormation
         console, choose the <b>Preserve successfully provisioned resources</b> option
         under <b>Stack failure options</b>. For more information, see <a href="./stack-failure-options.html">Choose how to handle failures when provisioning
   resources</a>. This allows you
         to log into your instance and view the log files to pinpoint issues encountered when
         running your startup scripts.</p>
      <p>Important logs to look at are:</p>
      <div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>The EC2 configuration log at
                  <code>%ProgramData%\Amazon\EC2Launch\log\agent.log</code></p>
         </li><li class="listitem">
            <p>The <b>cfn-init</b> log at
                  <code>C:\cfn\log\cfn-init.log</code></p>
         </li></ul></div>
      <p>For more logs, see the following topics in the <em>Amazon EC2 User
         Guide</em>:</p>
      <div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2config-service.html#UsingConfigXML_WinAMI">EC2Launch directory structure</a></p>
         </li><li class="listitem">
            <p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2launch-v2.html#ec2launch-v2-directory">EC2Launch v2 directory structure</a></p>
         </li></ul></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./cfn-windows-stacks.html">Windows-based stacks</div><div id="next" class="next-link" accesskey="n" href="./cloudformation-supplied-resource-types.html">Use CloudFormation-supplied
            resource types</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/cfn-windows-stacks-bootstrapping.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>