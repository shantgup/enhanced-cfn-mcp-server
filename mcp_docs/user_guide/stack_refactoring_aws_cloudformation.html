<!-- Source URL: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html -->
<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Stack refactoring - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stack-refactoring" /><meta name="default_state" content="stack-refactoring" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" /><meta name="description" content="Stack refactoring simplifies stack reorganization, like moving resources between stacks or splitting larger stacks, while maintaining the same properties and data." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><head xmlns="http://www.w3.org/1999/xhtml"> <script defer="" src="/assets/r/awsdocs-doc-page.2.0.0.js"></script><link href="/assets/r/awsdocs-doc-page.2.0.0.css" rel="stylesheet"/></head>
<script defer="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Stack refactoring" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Stack refactoring - AWS CloudFormation</title><meta name="pdf" content="/pdfs/AWSCloudFormation/latest/UserGuide/cfn-ug.pdf#stack-refactoring" /><meta name="rss" content="aws-cloudformation-user-guide-updates.rss" /><meta name="forums" content="https://repost.aws/tags/TAm3R3LNU3RfSX9L23YIpo3w" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-refactoring.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set,CloudFormation stacks,create a collection of resources as a CloudFormation stack" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Managing AWS resources as a single unit with AWS CloudFormation stacks",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Stack refactoring",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AWSCloudFormation/latest/UserGuide/cfn-ug.pdf#stack-refactoring" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#stack-refactoring-overview">How stack refactoring works</a><a href="#stack-refactoring-limits">Stack refactoring limitations</a><a href="#stack-refactoring-cli">Refactoring a stack using the AWS Command Line Interface</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="stack-refactoring">Stack refactoring</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Stack refactoring simplifies reorganizing the resources in your CloudFormation stacks while
        still preserving the existing resource properties and data. With stack refactoring, you can
        move resources between stacks, split monolithic stacks into smaller components, or
        consolidate multiple stacks into one.</p>
        <h2 id="stack-refactoring-overview">How stack refactoring works</h2>
        <p>Take the steps below into consideration when planning your stack refactor:</p>
        <div class="procedure"><ol><li>
                <p><b>Assess your current infrastructure:</b> Review
                    your existing CloudFormation stacks and resources to identify stack refactoring
                    opportunities.</p>
            </li><li>
                <p><b>Plan your refactor:</b> Define how resource
                    should be organized. Consider your dependencies, naming conventions, and
                    operational limits. These can affect the CloudFormation validation later.</p>
                <p>Determine the number of destination stacks you will be refactoring resources
                    into. You can move resource between at least 2 stacks, and a maximum of 5
                    stacks. Resources can be moved between nested stacks.</p>
            </li><li>
                <p><b>Update your templates:</b> Modify your CloudFormation
                    templates to reflect the planned change, such as moving resource definitions
                    between templates. You can rename logical IDs during refactoring.</p>
            </li><li>
                <p><b>Create the stack refactor:</b> Provide a list of
                    stack names and templates that you want to refactor.</p>
            </li><li>
                <p><b>Review the refactor impact on your infrastructure and
                        resolve any conflicts:</b> CloudFormation validates the templates you
                    provide and checks cross-stack dependencies, resource types with tag update
                    problems, and resource logical ID conflicts.</p>
                <p>If the validation succeeds, CloudFormation will generate a preview of the refactor
                    actions that will happen after executing the refactor.</p>
                <p>If the validation fails, you can retry after resolving the issues found. If
                    there are conflicts, you will need to provide a resource logical ID mapping that
                    shows the source and destination of the resource in conflict.</p>
            </li><li>
                <p><b>Execute the refactor:</b> After confirming the
                    changes align with how you want to refactor your stacks, execute the stack
                    refactor.</p>
            </li><li>
                <p><b>Monitor:</b> See the <code class="code">ExecutionStatus</code>
                    for the status of the stack refactor to make sure it's successful.</p>
            </li></ol></div>
     
        <h2 id="stack-refactoring-limits">Stack refactoring limitations</h2>
        <p>Consider the following limitations when planning your stack refactor:</p>
        <div class="itemizedlist">
             
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Refactor operations don't allow new resource creations, resource deletions, or
                    changes to resource configurations.</p>
            </li><li class="listitem">
                <p>You can't change or add new parameters, conditions, or mappings during a stack
                    refactor. A potential workaround is to update your stack before performing the
                    refactor.</p>
            </li><li class="listitem">
                <p>You can't refactor the same resource into multiple stacks.</p>
            </li><li class="listitem">
                <p>You cannot refactor a resource to a new stack if that stack uses certain
                    pseudo parameters (Example: <code class="code">AWS::StackName</code>).</p>
            </li><li class="listitem">
                <p>CloudFormation does not support empty stacks. Prior to creating a stack refactor
                    that would remove all existing resources from a stack, you must add a resource
                    to that stack. This resource can be a simple one, like a
                        <code class="code">waitCondition</code> resource type.</p>
            </li><li class="listitem">
                <p>Stack refactor does not support stacks that contain stack policies, including
                    policies allowing changes for resources.</p>
            </li><li class="listitem">
                <p>The following resources aren't available:</p>
                <div class="itemizedlist">
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
<ul class="itemizedlist"><li class="listitem"><p><code class="code">AWS::ACMPCA::Certificate</code></p></li><li class="listitem"><p><code class="code">AWS::ACMPCA::CertificateAuthority</code></p></li><li class="listitem"><p><code class="code">AWS::ACMPCA::CertificateAuthorityActivation</code></p></li><li class="listitem"><p><code class="code">AWS::ApiGateway::BasePathMapping</code></p></li><li class="listitem"><p><code class="code">AWS::ApiGateway::Method</code></p></li><li class="listitem"><p><code class="code">AWS::AppConfig::ConfigurationProfile</code></p></li><li class="listitem"><p><code class="code">AWS::AppConfig::Deployment</code></p></li><li class="listitem"><p><code class="code">AWS::AppConfig::Environment</code></p></li><li class="listitem"><p><code class="code">AWS::AppConfig::Extension</code></p></li><li class="listitem"><p><code class="code">AWS::AppConfig::ExtensionAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::AppStream::DirectoryConfig</code></p></li><li class="listitem"><p><code class="code">AWS::AppStream::StackFleetAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::AppStream::StackUserAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::AppStream::User</code></p></li><li class="listitem"><p><code class="code">AWS::BackupGateway::Hypervisor</code></p></li><li class="listitem"><p><code class="code">AWS::CodePipeline::CustomActionType</code></p></li><li class="listitem"><p><code class="code">AWS::Cognito::UserPoolRiskConfigurationAttachment</code></p></li><li class="listitem"><p><code class="code">AWS::Cognito::UserPoolUICustomizationAttachment</code></p></li><li class="listitem"><p><code class="code">AWS::Cognito::UserPoolUserToGroupAttachment</code></p></li><li class="listitem"><p><code class="code">AWS::Config::ConfigRule</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Dataset</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Job</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Project</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Recipe</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Ruleset</code></p></li><li class="listitem"><p><code class="code">AWS::DataBrew::Schedule</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::DataSource</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::Environment</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::EnvironmentBlueprintConfiguration</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::EnvironmentProfile</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::Project</code></p></li><li class="listitem"><p><code class="code">AWS::DataZone::SubscriptionTarget</code></p></li><li class="listitem"><p><code class="code">AWS::DynamoDB::GlobalTable</code></p></li><li class="listitem"><p><code class="code">AWS::EC2::LaunchTemplate</code></p></li><li class="listitem"><p><code class="code">AWS::EC2::SpotFleet</code></p></li><li class="listitem"><p><code class="code">AWS::EC2::VolumeAttachment</code></p></li><li class="listitem"><p><code class="code">AWS::EC2::VPCDHCPOptionsAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::ElasticBeanstalk::ConfigurationTemplate</code></p></li><li class="listitem"><p><code class="code">AWS::FIS::ExperimentTemplate</code></p></li><li class="listitem"><p><code class="code">AWS::Glue::Schema</code></p></li><li class="listitem"><p><code class="code">AWS::GuardDuty::IPSet</code></p></li><li class="listitem"><p><code class="code">AWS::GuardDuty::PublishingDestination</code></p></li><li class="listitem"><p><code class="code">AWS::GuardDuty::ThreatIntelSet</code></p></li><li class="listitem"><p><code class="code">AWS::ImageBuilder::Component</code></p></li><li class="listitem"><p><code class="code">AWS::IoTFleetWise::Campaign</code></p></li><li class="listitem"><p><code class="code">AWS::IoTWireless::WirelessDeviceImportTask</code></p></li><li class="listitem"><p><code class="code">AWS::Lambda::EventInvokeConfig</code></p></li><li class="listitem"><p><code class="code">AWS::Lex::BotVersion</code></p></li><li class="listitem"><p><code class="code">AWS::M2::Application</code></p></li><li class="listitem"><p><code class="code">AWS::Maester::DocumentType</code></p></li><li class="listitem"><p><code class="code">AWS::MediaTailor::Channel</code></p></li><li class="listitem"><p><code class="code">AWS::MSK::Configuration</code></p></li><li class="listitem"><p><code class="code">AWS::MSK::ServerlessCluster</code></p></li><li class="listitem"><p><code class="code">AWS::NeptuneGraph::PrivateGraphEndpoint</code></p></li><li class="listitem"><p><code class="code">AWS::Omics::AnnotationStore</code></p></li><li class="listitem"><p><code class="code">AWS::Omics::ReferenceStore</code></p></li><li class="listitem"><p><code class="code">AWS::Omics::SequenceStore</code></p></li><li class="listitem"><p><code class="code">AWS::OpenSearchServerless::Collection</code></p></li><li class="listitem"><p><code class="code">AWS::Panorama::PackageVersion</code></p></li><li class="listitem"><p><code class="code">AWS::PCAConnectorAD::Connector</code></p></li><li class="listitem"><p><code class="code">AWS::PCAConnectorAD::DirectoryRegistration</code></p></li><li class="listitem"><p><code class="code">AWS::PCAConnectorAD::Template</code></p></li><li class="listitem"><p><code class="code">AWS::PCAConnectorAD::TemplateGroupAccessControlEntry</code></p></li><li class="listitem"><p><code class="code">AWS::QuickSight::Theme</code></p></li><li class="listitem"><p><code class="code">AWS::RefactorSpaces::Environment</code></p></li><li class="listitem"><p><code class="code">AWS::RefactorSpaces::Route</code></p></li><li class="listitem"><p><code class="code">AWS::RefactorSpaces::Service</code></p></li><li class="listitem"><p><code class="code">AWS::RoboMaker::RobotApplication</code></p></li><li class="listitem"><p><code class="code">AWS::RoboMaker::SimulationApplication</code></p></li><li class="listitem"><p><code class="code">AWS::SageMaker::InferenceComponen</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalog::PortfolioPrincipalAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalog::PortfolioProductAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalog::PortfolioShare</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalog::TagOptionAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalogAppRegistry::AttributeGroupAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::ServiceCatalogAppRegistry::ResourceAssociation</code></p></li><li class="listitem"><p><code class="code">AWS::StepFunctions::StateMachineVersion</code></p></li><li class="listitem"><p><code class="code">AWS::Synthetics::Canary</code></p></li><li class="listitem"><p><code class="code">AWS::VoiceID::Domain</code></p></li><li class="listitem"><p><code class="code">AWS::WAFv2::IPSet</code></p></li><li class="listitem"><p><code class="code">AWS::WAFv2::RegexPatternSet</code></p></li><li class="listitem"><p><code class="code">AWS::WAFv2::RuleGroup</code></p></li><li class="listitem"><p><code class="code">AWS::WAFv2::WebACL</code></p></li></ul></div>
            </li></ul></div>
     
        <h2 id="stack-refactoring-cli">Refactoring a stack using the AWS Command Line Interface</h2>
        <p>The following commands are used for stack refactoring:</p>
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/create-stack-refactor.html">create-stack-refactor</a></p>
            </li><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-refactor.html">describe-stack-refactor</a>
                </p>
            </li><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/execute-stack-refactor.html">execute-stack-refactor</a>
                </p>
            </li><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stack-refactors.html">list-stack-refactors</a>
                </p>
            </li><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stack-refactor-actions.html">list-stack-refactor-actions</a>
                </p>
            </li></ul></div>
        <p>Below is an example of how to refactor a stack using the AWS Command Line Interface (CLI).</p>
        <div class="procedure"><ol><li>
                <p>To begin, you will need the CloudFormation template you wish to refactor. The
                    following command retrieves the template:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (cli)--><code class="nohighlight " data-source="content">aws cloudformation get-template --stack-name <code class="replaceable">ExampleStack1</code></code></pre>
                <p>Once you have the template, use the integrated development environment (IDE)
                    of your choice to update it to use the desired structure and resource
                    organization.</p>
            </li><li>
                <p>Create the stack refactor using the <code class="code">create-stack-refactor</code>
                    command, and provide the stack name and templates for each stack involved in
                    refactoring:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (cli)--><code class="nohighlight " data-source="content">aws cloudformation create-stack-refactor \
  --stack-definitions \
    StackName=<code class="replaceable">MySns</code>,TemplateBody@=<code class="replaceable">file://afterSns.yaml</code> \
    StackName=<code class="replaceable">MyLambdaSubscription</code>,TemplateBody@=<code class="replaceable">file://afterLambda.yaml</code> \
  --enable-stack-creation \ 
  --resource-mappings <code class="replaceable">file://refactor.json</code>
</code></pre>
    <p>The <code class="code">--resource-mappings</code> parameter is optional, but it will be required if a conflict is detected
     during template validation. In addition to providing the <code class="code">Source</code> and <code class="code">Destination</code> stacks,
     you will also need to provide the <code class="code">LogicalResourceId</code>. The following is an example
      <code class="code">refactor.json</code> file.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">[
    <span>{</span>
        "Source": <span>{</span>
            "StackName": "MySns",
            "LogicalResourceId": "MyFunction"
        },
        "Destination": <span>{</span>
            "StackName": "MyLambdaSubscription",
            "LogicalResourceId": "Function"
        }
    }
]</code></pre>

            </li><li>
                <p>After creating the refactor, CloudFormation generates a refactor change preview,
                    which allows you to preview the impact the proposed changes will have on your
                    infrastructure. In this example, the <code class="code">StackRefactorId</code> created is
                        <code class="code">stack-refactor-1ab2-c34d-5ef6</code>. Use the following command to
                    preview the changes:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (cli)--><code class="nohighlight " data-source="content">aws cloudformation list-stack-refactor-actions \
  --stack-refactor-id <code class="replaceable">stack-refactor-1ab2-c34d-5ef6</code></code></pre>
            </li><li>
                <p>After reviewing and confirming your changes, use the
                        <code class="code">execute-stack-refactor</code> command to complete the refactoring
                    process:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (cli)--><code class="nohighlight " data-source="content">aws cloudformation execute-stack-refactor \
  --stack-refactor-id <code class="replaceable">stack-refactor-1ab2-c34d-5ef6</code></code></pre>
            </li><li>
                <p>After executing <code class="code">execute-stack-refactor</code>, you can monitor the
                    status of the operation using the following command:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (cli)--><code class="nohighlight " data-source="content">aws cloudformation describe-stack-refactor \
  --stack-refactor-id <code class="replaceable">stack-refactor-1ab2-c34d-5ef6</code></code></pre>
                <p>CloudFormation will automatically update the <code class="code">Status</code> and
                        <code class="code">ExecutionStatus</code> of the refactor operation.</p>
            </li></ol></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./resource-import-revert.html">Reverting an import
         operation</div><div id="next" class="next-link" accesskey="n" href="./resource-import-supported-resources.html">Resource type
      support</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-refactoring.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-refactoring.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>