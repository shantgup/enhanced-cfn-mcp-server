<!-- Source URL: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatepolicy.html -->
<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>UpdatePolicy attribute - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-attribute-updatepolicy" /><meta name="default_state" content="aws-attribute-updatepolicy" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" /><meta name="description" content="Specify how to handle updates for the following resources with the UpdatePolicy attribute: AWS::AppStream::Fleet, AWS::AutoScaling::AutoScalingGroup, AWS::AutoScaling::AutoScalingGroup, AWS::ElastiCache::ReplicationGroup, AWS::OpenSearchService::Domain, AWS::Elasticsearch::Domain, or AWS::Lambda::Alias." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Template Reference" /><meta name="abstract" content="Describes the resource types, resource properties, resource attributes, intrinsic functions, and transforms that you can use in CloudFormation templates." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Template Reference" /><head xmlns="http://www.w3.org/1999/xhtml"> <script defer="" src="/assets/r/awsdocs-doc-page.2.0.0.js"></script><link href="/assets/r/awsdocs-doc-page.2.0.0.css" rel="stylesheet"/></head>
<script defer="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Template Reference" /><meta id="panorama-serviceConsolePage" value="UpdatePolicy attribute" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>UpdatePolicy attribute - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-template-reference-updates.rss" /><meta name="forums" content="https://repost.aws/tags/TAm3R3LNU3RfSX9L23YIpo3w" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,CloudFormation template reference" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Template Reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Resource attribute reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-product-attribute-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "UpdatePolicy attribute",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-product-attribute-reference.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="introduction.html">Template Reference</a></div><div id="page-toc-src"><a href="#aws-resource-update-policies">Overview</a><a href="#aws-attribute-update-policy-app-stream-fleet">AppStream 2.0 update policy</a><a href="#cfn-attributes-updatepolicy-replacingupdate">AutoScalingReplacingUpdate
        policy</a><a href="#cfn-attributes-updatepolicy-rollingupdate">AutoScalingRollingUpdate
        policy</a><a href="#cfn-attributes-updatepolicy-scheduledactions">AutoScalingScheduledAction
        policy</a><a href="#cfn-attributes-updatepolicy-useonlineresharding">UseOnlineResharding
        policy</a><a href="#cfn-attributes-updatepolicy-upgradeopensearchdomain">EnableVersionUpgrade
        policy</a><a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate">CodeDeployLambdaAliasUpdate policy</a><a href="#aws-attribute-updatepolicy-examples">Examples</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>This is the new <em>AWS CloudFormation Template Reference Guide</em>.
         Please update your bookmarks and links. For help getting started with CloudFormation, see the
            <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html">AWS CloudFormation User Guide</a>.</p></awsui-alert><h1 class="topictitle" id="aws-attribute-updatepolicy"><code class="code">UpdatePolicy</code> attribute</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Use the <code class="code">UpdatePolicy</code> attribute to specify how AWS CloudFormation handles updates to certain
    resources during stack update operations. </p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><p><a href="#aws-resource-update-policies">Overview</a></p></li><li><p><a href="#aws-attribute-update-policy-app-stream-fleet">AppStream 2.0 update policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-replacingupdate">AutoScalingReplacingUpdate
        policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-rollingupdate">AutoScalingRollingUpdate
        policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-scheduledactions">AutoScalingScheduledAction
        policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-useonlineresharding">UseOnlineResharding
        policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-upgradeopensearchdomain">EnableVersionUpgrade
        policy</a></p></li><li><p><a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate">CodeDeployLambdaAliasUpdate policy</a></p></li><li><p><a href="#aws-attribute-updatepolicy-examples">Examples</a></p></li></ul></div>
    <h2 id="aws-resource-update-policies">Overview</h2>
    <p>By using the <code class="code">UpdatePolicy</code> attribute, you can control how the following
      resources are updated, as described here:</p>
    <div class="itemizedlist">
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-appstream-fleet.html">AWS::AppStream::Fleet</a></span> â CloudFormation can stop and start a fleet,
          which causes the fleet's instances to be replaced. By doing so, all instances will have
          the latest changes applied immediately after a stack update.</p>
      </li><li class="listitem">
        <p><span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-autoscaling-autoscalinggroup.html">AWS::AutoScaling::AutoScalingGroup</a></span> â With
          Auto Scaling groups, you can use one or more update policies to control how CloudFormation handles
          certain updates. These policies include:</p>
        <div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><span class="topcom"><code class="code">AutoScalingReplacingUpdate</code> and
                  <code class="code">AutoScalingRollingUpdate</code> policies</span> â CloudFormation can
              either replace the Auto Scaling group and its instances with an
                <code class="code">AutoScalingReplacingUpdate</code> policy, or replace only the instances with
              an <code class="code">AutoScalingRollingUpdate</code> policy. These replacement operations occur
              when you make one or more of the following changes:</p>
            <div class="itemizedlist">
               
               
               
               
               
            <ul class="itemizedlist"><li class="listitem">
                <p>Change the Auto Scaling group's <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-autoscaling-launchconfiguration.html">AWS::AutoScaling::LaunchConfiguration</a>.</p>
              </li><li class="listitem">
                <p>Change the Auto Scaling group's <code class="code">VPCZoneIdentifier</code> property.</p>
              </li><li class="listitem">
                <p>Change the Auto Scaling group's <code class="code">LaunchTemplate</code> property.</p>
              </li><li class="listitem">
                <p>Change the Auto Scaling group's <code class="code">PlacementGroup</code> property.</p>
              </li><li class="listitem">
                <p>Update an Auto Scaling group that contains instances that don't match the current
                    <code class="code">LaunchConfiguration</code>.</p>
              </li></ul></div>
            <p>If both the <code class="code">AutoScalingReplacingUpdate</code> and
                <code class="code">AutoScalingRollingUpdate</code> policies are specified, setting the
                <code class="code">WillReplace</code> property to <code class="code">true</code> gives
                <code class="code">AutoScalingReplacingUpdate</code> precedence.</p>
          </li><li class="listitem">
            <p><span class="topcom"><code class="code">AutoScalingScheduledAction</code> policy</span>
              â This policy applies when you update a stack that includes an Auto Scaling group with
              scheduled actions that scale the group at specific times. CloudFormation can't modify the
              minimum size, maximum size, or desired capacity of the group unless they have been
              explicitly changed in the stack template. This policy helps to prevent any unexpected
              updates that could interfere with the scheduled scaling activities.</p>
          </li></ul></div>
      </li><li class="listitem">
        <p><span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-elasticache-replicationgroup.html">AWS::ElastiCache::ReplicationGroup</a></span> â
          CloudFormation can modify a replication group's shards by adding or removing shards, rather
          than replacing the entire resource. </p>
      </li><li class="listitem">
        <p><span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-opensearchservice-domain.html">AWS::OpenSearchService::Domain</a></span> and <span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-elasticsearch-domain.html">AWS::Elasticsearch::Domain</a></span> (legacy) â
          CloudFormation can upgrade an OpenSearch Service domain to a new version of OpenSearch or Elasticsearch
          without replacing the entire resource. </p>
      </li><li class="listitem">
        <p><span class="topcom"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-lambda-alias.html">AWS::Lambda::Alias</a></span> â CloudFormation can perform a
          CodeDeploy deployment when the version changes on the alias. </p>
      </li></ul></div>
    <p>The sections that follow describe the syntax and properties for the
        <code class="code">UpdatePolicy</code> attribute supported by each resource type.</p>
   
    <h2 id="aws-attribute-update-policy-app-stream-fleet">AppStream 2.0 update policy</h2>
    <p>To stop an AppStream 2.0 fleet before an update and restart it after an update, use the AppStream 2.0
      update policy. </p>
     
      <h3 id="aws-attribute-update-policy-app-stream-fleet-syntax">Syntax</h3>
      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-update-policy-app-stream-fleet-syntax-json">JSON</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json "><span>{</span>
    "UpdatePolicy": <span>{</span>
        "<a href="#cfn-attributes-updatepolicy-replacingupdate-StopBeforeUpdate">StopBeforeUpdate</a>": <span>{</span>
            "Type": "<code class="replaceable">Boolean</code>"
        },
        "<a href="#cfn-attributes-updatepolicy-replacingupdate-StartAfterUpdate">StartAfterUpdate</a>": <span>{</span>
            "Type": "<code class="replaceable">Boolean</code>"
        }
    }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-update-policy-app-stream-fleet-syntax-yaml">YAML</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-replacingupdate-StopBeforeUpdate">StopBeforeUpdate</a>:
    Type: <code class="replaceable">Boolean</code>
  <a href="#cfn-attributes-updatepolicy-replacingupdate-StartAfterUpdate">StartAfterUpdate</a>:
    Type: <code class="replaceable">Boolean</code></code></pre>
      </div>
      <div class="variablelist">
         
         
      <dl>
          <dt id="cfn-attributes-updatepolicy-replacingupdate-StopBeforeUpdate"><span class="term"><code class="code">StopBeforeUpdate</code></span></dt>
          <dd>
            <p>Stops the specified fleet before the update.</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-replacingupdate-StartAfterUpdate"><span class="term"><code class="code">StartAfterUpdate</code></span></dt>
          <dd>
            <p>Starts the specified fleet after the update.</p>
            <p><em>Required</em>: No</p>
          </dd>

        </dl></div>
     
   
    <h2 id="cfn-attributes-updatepolicy-replacingupdate">AutoScalingReplacingUpdate
        policy</h2>
    <p>To replace the Auto Scaling group and the instances it contains, use the
        <code class="code">AutoScalingReplacingUpdate</code> policy.</p>
    <p>Before attempting an update, ensure that you have sufficient Amazon EC2 capacity for both your
      old and new Auto Scaling groups.</p>


     
      <h3 id="cfn-attributes-updatepolicy-replacingupdate-syntax">Syntax</h3>

      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-replacingupdate-syntax.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-replacingupdate">AutoScalingReplacingUpdate</a>" : <span>{</span>
    "<a href="#cfn-attributes-updatepolicy-replacingupdate-willreplace">WillReplace</a>" : <code class="replaceable">Boolean</code>
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-replacingupdate-syntax.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-replacingupdate">AutoScalingReplacingUpdate</a>:
    <a href="#cfn-attributes-updatepolicy-replacingupdate-willreplace">WillReplace</a>: <code class="replaceable">Boolean</code></code></pre>
      </div>
     
     
      <h3 id="cfn-attributes-updatepolicy-replacingupdate-properties">Properties</h3>

      <div class="variablelist">
         
      <dl>
          <dt id="cfn-attributes-updatepolicy-replacingupdate-willreplace"><span class="term"><code class="code">WillReplace</code></span></dt>
          <dd>
            <p>Specifies whether an Auto Scaling group and the instances it contains are replaced during
              an update. During replacement, CloudFormation retains the old group until it finishes
              creating the new one. If the update fails, CloudFormation can roll back to the old Auto Scaling
              group and delete the new Auto Scaling group.</p>
            <p>While CloudFormation creates the new group, it doesn't detach or attach any instances.
              After successfully creating the new Auto Scaling group, CloudFormation deletes the old Auto Scaling group
              during the cleanup process.</p>
            <p>When you set the <code class="code">WillReplace</code> parameter, remember to specify a
              matching <a href="./aws-attribute-creationpolicy.html">CreationPolicy attribute</a>. If the minimum number of instances
              (specified by the <code class="code">MinSuccessfulInstancesPercent</code> property) don't signal
              success within the <code class="code">Timeout</code> period (specified in the
                <code class="code">CreationPolicy</code> attribute), the replacement update fails and CloudFormation
              rolls back to the old Auto Scaling group.</p>
            <p><em>Type</em>: Boolean</p>
            <p><em>Required</em>: No</p>
          </dd>
        </dl></div>
     
   
    <h2 id="cfn-attributes-updatepolicy-rollingupdate">AutoScalingRollingUpdate
        policy</h2>

    <p>To perform a rolling update of the instances in an Auto Scaling group rather than wait for scaling
      activities to gradually replace older instances with newer instances, use the
        <code class="code">AutoScalingRollingUpdate</code> policy. This policy provides you the flexibility to
      specify whether CloudFormation replaces instances that are in an Auto Scaling group in batches or all at
      once without replacing the entire resource. </p>
    <p>Things to consider when using an <code class="code">AutoScalingRollingUpdate</code> policy:</p>
    <div class="itemizedlist">
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>When CloudFormation rolls back an update, it uses the <code class="code">UpdatePolicy</code>
          configuration specified in the template before the current stack update. For example, you
          change the <code class="code">MaxBatchSize</code> from 1 to 10 in the <code class="code">UpdatePolicy</code>,
          perform a stack update, and that update fails. CloudFormation will use 1 as the maximum batch
          size when it rolls back, not 10. To avoid this scenario, make changes to the
            <code class="code">UpdatePolicy</code> in a separate update before any updates to the Auto Scaling group that
          are likely to initiate rolling updates.</p>
      </li><li class="listitem">
        <p>CloudFormation recommends specifying the <code class="code">SuspendProcesses</code> property to
          temporarily suspend Amazon EC2 Auto Scaling processes that might interfere with the rolling update and
          cause it to fail. For more information, see <a href="https://repost.aws/knowledge-center/auto-scaling-group-rolling-updates" rel="noopener noreferrer" target="_blank"><span>How can I update
            my Auto Scaling group when I update my CloudFormation stack?</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
      </li><li class="listitem">
        <p>CloudFormation supports using Amazon EC2 Auto Scaling lifecycle hooks when launching or terminating
          instances. This gives you time to perform custom actions on an instance before it moves to
          the next state. To make sure that new instances reach the <code class="code">InService</code> state,
          complete the lifecycle hook with a <code class="code">CONTINUE</code> result when the custom action
          finishes. By default, if no response is received and the lifecycle hook times out, the
          instance launch will be considered unsuccessful and abandoned. If no instances reach the
            <code class="code">InService</code> state, the rolling update will eventually fail.</p>
      </li><li class="listitem">
        <p>Amazon EC2 Auto Scaling features such as instance maintenance policies, termination policies, and
          scale-in protection are not available for use with CloudFormation rolling updates. Plan your
          rolling updates accordingly.</p>
      </li><li class="listitem">
        <p>If you use an <code class="code">AutoScalingRollingUpdate</code> policy and remove the placement
          group setting, the placement group will be removed from the Auto Scaling group and the CloudFormation
          template. Also this triggers a rolling update, so new instances won't be launched into a
          placement group.</p>
      </li></ul></div>
     
      <h3 id="cfn-attributes-updatepolicy-rollingupdate-syntax">Syntax</h3>

      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-rollingupdate-syntax.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-rollingupdate">AutoScalingRollingUpdate</a>" : <span>{</span>
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-maxbatchsize">MaxBatchSize</a>" : <code class="replaceable">Integer</code>,
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-minactiveinstancespercent">MinActiveInstancesPercent</a>" : <code class="replaceable">Integer</code>,
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-mininstancesinservice">MinInstancesInService</a>" : <code class="replaceable">Integer</code>,
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-minsuccessfulinstancespercent">MinSuccessfulInstancesPercent</a>" : <code class="replaceable">Integer</code>,
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-pausetime">PauseTime</a>" : <code class="replaceable">String</code>,
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-suspendprocesses">SuspendProcesses</a>" : [ <code class="replaceable">List of processes</code> ],
    "<a href="#cfn-attributes-updatepolicy-rollingupdate-waitonresourcesignals">WaitOnResourceSignals</a>" : <code class="replaceable">Boolean</code>
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-rollingupdate-syntax.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-rollingupdate">AutoScalingRollingUpdate</a>:
    <a href="#cfn-attributes-updatepolicy-rollingupdate-maxbatchsize">MaxBatchSize</a>: <code class="replaceable">Integer</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-minactiveinstancespercent">MinActiveInstancesPercent</a>: <code class="replaceable">Integer</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-mininstancesinservice">MinInstancesInService</a>: <code class="replaceable">Integer</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-minsuccessfulinstancespercent">MinSuccessfulInstancesPercent</a>: <code class="replaceable">Integer</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-pausetime">PauseTime</a>: <code class="replaceable">String</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-suspendprocesses">SuspendProcesses</a>:
      - <code class="replaceable">List of processes</code>
    <a href="#cfn-attributes-updatepolicy-rollingupdate-waitonresourcesignals">WaitOnResourceSignals</a>: <code class="replaceable">Boolean</code></code></pre>
      </div>
     
     
      <h3 id="aws-attribute-updatepolicy-rollingupdate-properties">Properties</h3>
      <div class="variablelist">
         
         
         
         
         
         
         
      <dl>
          <dt id="cfn-attributes-updatepolicy-rollingupdate-maxbatchsize"><span class="term"><code class="code">MaxBatchSize</code></span></dt>
          <dd>
            <p>Specifies the maximum number of instances that can be replaced
              simultaneously.</p>
            <p><em>Default</em>: <code class="code">1</code></p>
            <p><em>Maximum</em>: <code class="code">100</code></p>
            <p><em>Type</em>: Integer</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-minactiveinstancespercent"><span class="term"><code class="code">MinActiveInstancesPercent</code></span></dt>
          <dd>
            <p>Specifies the percentage of instances in an Auto Scaling group that must be in the
                <code class="code">InService</code> state relative to that group's desired capacity during a
              rolling update for an update to succeed. You can specify a value from 0 to 100.
              CloudFormation rounds to the nearest tenth of a percent. For example, if you update five
              instances with a minimum <code class="code">InService</code> percentage of 50, at least three
              instances must be in the <code class="code">InService</code> state. If an instance doesn't
              transition to the <code class="code">InService</code> state within a fixed time of 1 hour,
              CloudFormation assumes that the instance wasn't updated.</p>
            
            <p>Setting <code class="code">MinActiveInstancesPercent</code> in your <code class="code">UpdatePolicy</code>
              will also affect instances launched when the <code class="code">DesiredCapacity</code> property of
              the <code class="code">AWS::AutoScaling::AutoScalingGroup</code> resource is set higher than the
              current desired capacity of that Auto Scaling group.</p>
            <p><em>Default</em>: <code class="code">100</code></p>
            <p><em>Type</em>: Integer</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-mininstancesinservice"><span class="term"><code class="code">MinInstancesInService</code></span></dt>
          <dd>
            <p>Specifies the minimum number of instances that must be in service within the Auto Scaling
              group while CloudFormation updates old instances. This value must be less than the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-autoscaling-autoscalinggroup.html#cfn-autoscaling-autoscalinggroup-maxsize">MaxSize</a> of the Auto Scaling group.</p>
            <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>We recommend that you set the value of the <code class="code">MinInstancesInService</code>
                property to at least the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-autoscaling-autoscalinggroup.html#cfn-autoscaling-autoscalinggroup-minsize">MinSize</a> of the Auto Scaling group. This avoids potential
                availability issues during a rolling update due to 0 instances serving customer
                traffic. </p></div></div>
            <p><em>Default</em>: <code class="code">0</code></p>
            <p><em>Type</em>: Integer</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-minsuccessfulinstancespercent"><span class="term"><code class="code">MinSuccessfulInstancesPercent</code></span></dt>
          <dd>
            <p>Specifies the percentage of instances in an Auto Scaling rolling update that must signal
              success for an update to succeed. You can specify a value from 0 to 100. CloudFormation
              rounds to the nearest tenth of a percent. For example, if you update five instances
              with a minimum successful percentage of <code class="code">50</code>, three instances must signal
              success. If an instance doesn't send a signal within the time specified in the
                <code class="code">PauseTime</code> property, CloudFormation assumes that the instance wasn't
              updated.</p>
            <p>We recommend that you set the value of the
                <code class="code">MinSuccessfulInstancesPercent</code> property to a value greater than 0. When
              the <code class="code">MinSuccessfulInstancesPercent</code> property is set to 0, CloudFormation waits
              for 0% of the capacity instances to be in an <code class="code">InService</code> state.
                <code class="code">MinSuccessfulInstancesPercent</code> returns immediately and before
              considering the Auto Scaling group status as <code class="code">UPDATE_COMPLETE</code> to move on to the
              subsequent resources defined in the stack template. If other Auto Scaling groups are defined
              in your CloudFormation template, they will update simultaneously. When all Auto Scaling groups are
              deployed at once with 0% of the capacity instances in an <code class="code">InService</code> state,
              then you will experience availability issues, due to 0 instances serving customer
              traffic.</p>
            
            <p><em>Default</em>: <code class="code">100</code></p>
            <p><em>Type</em>: Integer</p>
            <p><em>Required</em>: No</p>
          </dd>

         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-pausetime"><span class="term"><code class="code">PauseTime</code></span></dt>
          <dd>
            <p>The amount of time that CloudFormation pauses after making a change to a batch of
              instances to give those instances time to start software applications. </p>
            <p>Specify <code class="code">PauseTime</code> in the <a href="https://en.wikipedia.org/wiki/ISO_8601#Durations" rel="noopener noreferrer" target="_blank"><span>ISO8601 duration
                format</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> (in the format
                  <code class="code">PT<code class="replaceable">#</code>H<code class="replaceable">#</code>M<code class="replaceable">#</code>S</code>,
              where each <code class="replaceable">#</code> is the number of hours, minutes, and seconds,
              respectively). The maximum <code class="code">PauseTime</code> is one hour
              (<code class="code">PT1H</code>).</p>
            <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>When <code class="code">WaitOnResourceSignals</code> is set to <code class="code">true</code>,
                  <code class="code">PauseTime</code> acts as a timeout value. It determines the maximum time
                that CloudFormation waits to receive the required number of valid signals from the
                instances being replaced during a rolling update and from new instances being added
                by increasing the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-autoscaling-autoscalinggroup.html#cfn-autoscaling-autoscalinggroup-desiredcapacity">DesiredCapacity</a> property of the
                  <code class="code">AWS::AutoScaling::AutoScalingGroup</code> resource. If the
                  <code class="code">PauseTime</code> is exceeded before CloudFormation receives the expected
                signals, the update fails. For best results, specify a time period that provides
                sufficient time for your applications to start up. If the update needs to be rolled
                back, a short <code class="code">PauseTime</code> can cause the rollback to fail.</p></div></div>
            
            <p><em>Default</em>: <code class="code">PT5M</code> (5 minutes) when the
                <code class="code">WaitOnResourceSignals</code> property is set to <code class="code">true</code>. Otherwise,
              no default value is set. </p>
            <p><em>Type</em>: String</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-suspendprocesses"><span class="term"><code class="code">SuspendProcesses</code></span></dt>
          <dd>
            <p>Specifies the Auto Scaling processes to suspend during a stack update. Suspending
              processes prevents Auto Scaling from interfering with a stack update. For example, you can
              suspend alarming so that Amazon EC2 Auto Scaling doesn't initiate scaling policies associated with an
              alarm. For valid values, see <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-suspend-resume-processes.html#process-types">Types
                of processes</a> in the <em>Amazon EC2 Auto Scaling User Guide</em>.</p>
            <p><em>Default</em>: Not specified</p>
            <p><em>Type</em>: List of Auto Scaling processes</p>
            <p><em>Required</em>: No</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-rollingupdate-waitonresourcesignals"><span class="term"><code class="code">WaitOnResourceSignals</code></span></dt>
          <dd>
            <p>Specifies whether CloudFormation waits for success signals from new instances before
              continuing the update. CloudFormation waits for the specified <code class="code">PauseTime</code>
              duration for success signals.</p>
            <p>To signal the Auto Scaling group, use the <a href="./cfn-signal.html">cfn-signal</a> helper script. For Auto Scaling groups associated with Elastic Load Balancing,
              consider adding a health check to ensure that instances are healthy before signaling
              success by using the <a href="./cfn-init.html">cfn-init</a> helper
              script. For an example, see the <code class="code">verify_instance_health</code> command in the
              sample templates for Amazon EC2 Auto Scaling rolling updates in our <a href="https://github.com/aws-cloudformation/aws-cloudformation-templates/tree/main/AutoScaling" rel="noopener noreferrer" target="_blank"><span>GitHub repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
            
            <p><em>Default</em>: <code class="code">false</code></p>
            <p><em>Type</em>: Boolean</p>
            <p><em>Required</em>: Conditional. If you specify the
                <code class="code">MinSuccessfulInstancesPercent</code> property, the
                <code class="code">WaitOnResourceSignals</code> property must be set to <code class="code">true</code>.</p>
          </dd>
        </dl></div>
     
   
    <h2 id="cfn-attributes-updatepolicy-scheduledactions">AutoScalingScheduledAction
        policy</h2>

    <p>To specify how CloudFormation handles updates for the <code class="code">MinSize</code>,
        <code class="code">MaxSize</code>, and <code class="code">DesiredCapacity</code> properties when the
        <code class="code">AWS::AutoScaling::AutoScalingGroup</code> resource has an associated scheduled action,
      use the <code class="code">AutoScalingScheduledAction</code> policy.</p>
    <p>With scheduled actions, the group size properties of an Auto Scaling group can change at any time.
      When you update a stack with an Auto Scaling group and scheduled action, CloudFormation always sets the
      group size property values of your Auto Scaling group to the values that are defined in the
        <code class="code">AWS::AutoScaling::AutoScalingGroup</code> resource of your template, even if a
      scheduled action is in effect.</p>
    <p>If you don't want CloudFormation to change any of the group size property values when you have
      a scheduled action in effect, use the <code class="code">AutoScalingScheduledAction</code> update policy
      and set <code class="code">IgnoreUnmodifiedGroupSizeProperties</code> to <code class="code">true</code> to prevent
      CloudFormation from changing the <code class="code">MinSize</code>, <code class="code">MaxSize</code>, or
        <code class="code">DesiredCapacity</code> properties unless you have modified these values in your
      template.</p>
    <p></p>

     
      <h3 id="cfn-attributes-updatepolicy-scheduledactions-syntax">Syntax</h3>

      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-scheduledactions-syntax.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-scheduledactions">AutoScalingScheduledAction</a>" : <span>{</span>
    "<a href="#cfn-attributes-updatepolicy-scheduledactions-ignoreunmodifiedgroupsizeproperties">IgnoreUnmodifiedGroupSizeProperties</a>" : <code class="replaceable">Boolean</code>
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-scheduledactions-syntax.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-scheduledactions">AutoScalingScheduledAction</a>:
    <a href="#cfn-attributes-updatepolicy-scheduledactions-ignoreunmodifiedgroupsizeproperties">IgnoreUnmodifiedGroupSizeProperties</a>: <code class="replaceable">Boolean</code></code></pre>
      </div>
     
     
      <h3 id="cfn-attributes-updatepolicy-scheduledactions-properties">Properties</h3>

      <div class="variablelist">
         
      <dl>
          <dt id="cfn-attributes-updatepolicy-scheduledactions-ignoreunmodifiedgroupsizeproperties"><span class="term"><code class="code">IgnoreUnmodifiedGroupSizeProperties</code></span></dt>
          <dd>
            <p>If <code class="code">true</code>, CloudFormation ignores differences in group size properties
              between your current Auto Scaling group and the Auto Scaling group described in the
                <code class="code">AWS::AutoScaling::AutoScalingGroup</code> resource of your template during a
              stack update. If you modify any of the group size property values in your template,
              CloudFormation uses the modified values and updates your Auto Scaling group.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>This property is ignored during a stack rollback.</p></div></div>
            <p><em>Default</em>: <code class="code">false</code></p>
            <p><em>Type</em>: Boolean</p>
            <p><em>Required</em>: No</p>
          </dd>
        </dl></div>
     
   
    <h2 id="cfn-attributes-updatepolicy-useonlineresharding">UseOnlineResharding
        policy</h2>
    <p>To modify a replication group's shards by adding or removing shards, rather than replacing
      the entire <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-elasticache-replicationgroup.html">AWS::ElastiCache::ReplicationGroup</a> resource, use the
        <code class="code">UseOnlineResharding</code> update policy.</p>
    <p>If <code class="code">UseOnlineResharding</code> is set to <code class="code">true</code>, you can update the
        <code class="code">NumNodeGroups</code> and <code class="code">NodeGroupConfiguration</code> properties of the
        <code class="code">AWS::ElastiCache::ReplicationGroup</code> resource, and CloudFormation will update those
      properties without interruption. When <code class="code">UseOnlineResharding</code> is set to
        <code class="code">false</code>, or not specified, updating the <code class="code">NumNodeGroups</code> and
        <code class="code">NodeGroupConfiguration</code> properties results in CloudFormation replacing the entire
        <code class="code">AWS::ElastiCache::ReplicationGroup</code> resource.</p>
    <p>The <code class="code">UseOnlineResharding</code> update policy has no properties.</p>
    <p>Things to consider when setting the <code class="code">UseOnlineResharding</code> update policy to
        <code class="code">true</code>:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>We strongly recommend you perform updates to the <code class="code">NumNodeGroups</code> and
            <code class="code">NodeGroupConfiguration</code> properties as the only updates in a given stack
          update operation.</p>
        <p>Updating the node group configuration of a replication group is a resource-intensive
          operation. If a stack update fails, CloudFormation doesn't roll back changes to the node group
          configuration of a replication group. However, CloudFormation will roll back any other
          properties that were changed as part of the failed update operation.</p>
      </li><li class="listitem">
        <p>Any node group updates require identifying all node groups.</p>
        <p>If you specify the <code class="code">NodeGroupConfiguration</code> property, you must also specify
          the NodeGroupId for each node group configuration in order for CloudFormation to update the
          number of nodes without interruption.</p>
        <p>When creating a replication group, if you don't specify an ID for each node group,
          ElastiCache automatically generates an ID for each node group. To update the replication group
          without interruption, use the ElastiCache console (<a href="https://console.aws.amazon.com/elasticache/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/elasticache/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>) or <a href="https://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_DescribeReplicationGroups.html">DescribeReplicationGroups</a>
          to retrieve the IDs for all node groups in the replication group. Then specify the ID for
          each node group in your stack template before attempting to add or remove shards.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>As a best practice, when you create a replication group in a stack template, include
            an ID for each node group you specify.</p></div></div>
        <p>In addition, updating the number of nodes without interruption requires that you have
          accurately specified the <code class="code">PrimaryAvailabilityZone</code>,
            <code class="code">ReplicaAvailabilityZones</code>, and <code class="code">ReplicaCount</code> properties for each
            <code class="code">NodeGroupConfiguration</code> as well. Again, you can use the ElastiCache console
          (<a href="https://console.aws.amazon.com/elasticache/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/elasticache/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>) or <a href="https://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_DescribeReplicationGroups.html">DescribeReplicationGroups</a>
          to retrieve the actual values for each node group and compare them to the values in your
          stack template. You can update the property values of the node groups as a separate stack
          update, or as part of the same stack update that changes the number of node groups.</p>
        <p>When you use an <code class="code">UseOnlineResharding</code> update policy to update the number of
          node groups without interruption, ElastiCache evenly distributes the keyspaces between the
          specified number of slots. This can't be updated later. Therefore, after updating the
          number of node groups in this way, you should remove the value specified for the
            <code class="code">Slots</code> property of each <code class="code">NodeGroupConfiguration</code> from the stack
          template, as it no longer reflects the actual values in each node group.</p>
      </li><li class="listitem">
        <p>Actual node group removal results may vary.</p>
        <p>When you specify a <code class="code">NumNodeGroups</code> value that's less than the current
          number of node groups, CloudFormation instructs ElastiCache to remove as many node groups as
          necessary to reach the specified number of nodes. However, ElastiCache may not always be able to
          remove the desired number of node groups. In the event ElastiCache can't remove the desired
          number of node groups, CloudFormation generates a stack event alerting you to this. In cases
          where ElastiCache can't remove <em>any</em> node groups, the CloudFormation resource
          update fails.</p>
      </li></ul></div>
    <p>For more information on modifying replication groups, see <a href="https://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_ModifyReplicationGroupShardConfiguration.html">ModifyReplicationGroupShardConfiguration</a> in the
        <em>Amazon ElastiCache API Reference</em>.</p>

     
      <h3 id="cfn-attributes-updatepolicy-useonlineresharding-syntax">Syntax</h3>
      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="cfn-attributes-updatepolicy-useonlineresharding-syntax.json">JSON</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-useonlineresharding">UseOnlineResharding</a>" : <code class="replaceable">Boolean</code>
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="cfn-attributes-updatepolicy-useonlineresharding-syntax.yaml">YAML</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-useonlineresharding">UseOnlineResharding</a>: <code class="replaceable">Boolean</code></code></pre>
      </div>
     
   
    <h2 id="cfn-attributes-updatepolicy-upgradeopensearchdomain">EnableVersionUpgrade
        policy</h2>

    <p>To upgrade an OpenSearch Service domain to a new version of OpenSearch or Elasticsearch rather than
      replacing the entire <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-opensearchservice-domain.html">AWS::OpenSearchService::Domain</a> or <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-elasticsearch-domain.html">AWS::Elasticsearch::Domain</a>
      resource, use the <code class="code">EnableVersionUpgrade</code> update policy.</p>
    <p>If <code class="code">EnableVersionUpgrade</code> is set to <code class="code">true</code>, you can update the
        <code class="code">EngineVersion</code> property of the <code class="code">AWS::OpenSearchService::Domain</code>
      resource (or the <code class="code">ElasticsearchVersion</code> property of the legacy
        <code class="code">AWS::Elasticsearch::Domain</code> resource), and CloudFormation will update that property
      without interruption. When <code class="code">EnableVersionUpgrade</code> is set to <code class="code">false</code>, or
      not specified, updating the <code class="code">EngineVersion</code> or <code class="code">ElasticsearchVersion</code>
      property results in CloudFormation replacing the entire
        <code class="code">AWS::OpenSearchService::Domain</code>/<code class="code">AWS::Elasticsearch::Domain</code>
      resource.</p>
    <p>The <code class="code">EnableVersionUpgrade</code> update policy has no properties.</p>
    <p>For more information, see <a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/version-migration.html">Upgrading OpenSearch Service
        domains</a> in the Amazon OpenSearch Service Developer Guide.</p>

     
      <h3 id="cfn-attributes-updatepolicy-upgradeopensearchdomain-syntax">Syntax</h3>

      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="cfn-attributes-updatepolicy-upgradeopensearchdomain-syntax.json">JSON</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-upgradeopensearchdomain">EnableVersionUpgrade</a>" : <code class="replaceable">Boolean</code>
}</code></pre>
      </div>

      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="cfn-attributes-updatepolicy-upgradeopensearchdomain-syntax.yaml">YAML</h4>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-upgradeopensearchdomain">EnableVersionUpgrade</a>: <code class="replaceable">Boolean</code></code></pre>
      </div>

     

   
    <h2 id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate">CodeDeployLambdaAliasUpdate policy</h2>

    <p>To perform an CodeDeploy deployment when the version changes on an
        <code class="code">AWS::Lambda::Alias</code> resource, use the <code class="code">CodeDeployLambdaAliasUpdate</code>
      update policy.</p>
     
      <h3 id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-syntax">Syntax</h3>

      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-codedeploylambdaaliasupdate-syntax.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "<a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate">CodeDeployLambdaAliasUpdate</a>" : <span>{</span>
    "<a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-afterallowtraffichook">AfterAllowTrafficHook</a>" : <code class="replaceable">String</code>,
    "<a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-applicationname">ApplicationName</a>" : <code class="replaceable">String</code>,
    "<a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-beforeallowtraffichook">BeforeAllowTrafficHook</a>" : <code class="replaceable">String</code>,
    "<a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-deploymentgroupname">DeploymentGroupName</a>" : <code class="replaceable">String</code>
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-codedeploylambdaaliasupdate-syntax.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  <a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate">CodeDeployLambdaAliasUpdate</a>:
    <a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-afterallowtraffichook">AfterAllowTrafficHook</a>: <code class="replaceable">String</code>
    <a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-applicationname">ApplicationName</a>: <code class="replaceable">String</code>
    <a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-beforeallowtraffichook">BeforeAllowTrafficHook</a>: <code class="replaceable">String</code>
    <a href="#cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-deploymentgroupname">DeploymentGroupName</a>: <code class="replaceable">String</code></code></pre>
      </div>
     
     
      <h3 id="aws-attribute-updatepolicy-codedeploylambdaaliasupdate-properties">Properties</h3>

      <div class="variablelist">
         
         
         
         
      <dl>
          <dt id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-afterallowtraffichook"><span class="term"><code class="code">AfterAllowTrafficHook</code></span></dt>
          <dd>
            <p>The name of the Lambda function to run after traffic routing completes.</p>
            <p><em>Required</em>: No</p>
            <p><em>Type: </em>String</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-applicationname"><span class="term"><code class="code">ApplicationName</code></span></dt>
          <dd>
            <p>The name of the CodeDeploy application.</p>
            <p><em>Required: </em>Yes</p>
            <p><em>Type: </em>String</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-beforeallowtraffichook"><span class="term"><code class="code">BeforeAllowTrafficHook</code></span></dt>
          <dd>
            <p>The name of the Lambda function to run before traffic routing starts.</p>
            <p><em>Required</em>: No</p>
            <p><em>Type: </em>String</p>
          </dd>
         
          <dt id="cfn-attributes-updatepolicy-codedeploylambdaaliasupdate-deploymentgroupname"><span class="term"><code class="code">DeploymentGroupName</code></span></dt>
          <dd>
            <p>The name of the CodeDeploy deployment group. This is where the traffic-shifting policy
              is set.</p>
            <p><em>Required</em>: Yes</p>
            <p><em>Type: </em>String</p>
          </dd>
        </dl></div>
      <p>For an example that specifies the <code class="code">UpdatePolicy</code> attribute for an
          <code class="code">AWS::Lambda::Alias</code> resource, see <a href="#aws-resource-lambda-alias-example">Lambda alias update policy</a>.</p>
     
   
    <h2 id="aws-attribute-updatepolicy-examples">Examples</h2>
    <p>The following examples show how to add an update policy to an Auto Scaling group and how to
      maintain availability when updating metadata.</p>
     
      <h3 id="aws-attribute-updatepolicy-example-1">Add an <code class="code">UpdatePolicy</code> to
          an Auto Scaling group</h3>

      <p>The following example shows how to add an update policy. During an update, the Auto Scaling
        group updates instances in batches of two and keeps a minimum of one instance in service.
        Because the <code class="code">WaitOnResourceSignals</code> flag is set, the Auto Scaling group waits for new
        instances that are added to the group. The new instances must signal the Auto Scaling group before
        it updates the next batch of instances.</p>
      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="attribute-updatepolicy-example-1.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"ASG" : <span>{</span>
  "Type":"AWS::AutoScaling::AutoScalingGroup",
  "Properties":<span>{</span>
    "VPCZoneIdentifier":[ "<code class="replaceable">subnetIdAz1</code>", "<code class="replaceable">subnetIdAz2</code>", "<code class="replaceable">subnetIdAz3</code>" ],
    "LaunchTemplate":<span>{</span>
      "LaunchTemplateId":<span>{</span>
        "Ref":"<code class="replaceable">logicalName</code>"
      },
      "Version":<span>{</span>
        "Fn::GetAtt":[
          "<code class="replaceable">logicalName</code>",
          "LatestVersionNumber"
        ]
      }
    },
    "MaxSize":"4",
    "MinSize":"1"
  },
  "UpdatePolicy":<span>{</span>
    "AutoScalingScheduledAction":<span>{</span>
      "IgnoreUnmodifiedGroupSizeProperties":"true"
    },
    "AutoScalingRollingUpdate":<span>{</span>
      "MinInstancesInService":"1",
      "MaxBatchSize":"2",
      "WaitOnResourceSignals":"true",
      "PauseTime":"PT10M",
      "SuspendProcesses":[
        "HealthCheck",
        "ReplaceUnhealthy",
        "AZRebalance",
        "AlarmNotification",
        "ScheduledActions",
        "InstanceRefresh"
      ]
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="attribute-updatepolicy-example-1.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">ASG:
  Type: 'AWS::AutoScaling::AutoScalingGroup'
  Properties:
    VPCZoneIdentifier:
      - <code class="replaceable">subnetIdAz1</code>
      - <code class="replaceable">subnetIdAz2</code>
      - <code class="replaceable">subnetIdAz3</code>
    LaunchTemplate:
      LaunchTemplateId: !Ref <code class="replaceable">logicalName</code>
      Version: !GetAtt <code class="replaceable">logicalName</code>.LatestVersionNumber
    MaxSize: '4'
    MinSize: '1'
  UpdatePolicy:
    AutoScalingScheduledAction:
      IgnoreUnmodifiedGroupSizeProperties: 'true'
    AutoScalingRollingUpdate:
      MinInstancesInService: '1'
      MaxBatchSize: '2'
      WaitOnResourceSignals: 'true'
      PauseTime: PT10M
      SuspendProcesses:
        - HealthCheck
        - ReplaceUnhealthy
        - AZRebalance
        - AlarmNotification
        - ScheduledActions
        - InstanceRefresh</code></pre>
      </div>
     
     
      <h3 id="attribute-updatepolicy-AutoScalingReplacingUpdate">AutoScalingReplacingUpdate policy</h3>

      <p>The following example declares a policy that forces an associated Auto Scaling group to be
        replaced during an update. For the update to succeed, a percentage of instances (specified
        by the <code class="code">MinSuccessfulPercentParameter</code> parameter) must signal success within the
          <code class="code">Timeout</code> period.</p>
      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="attribute-updatepolicy-example-2.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"UpdatePolicy" : <span>{</span>
  "AutoScalingReplacingUpdate" : <span>{</span>
    "WillReplace" : true
  }
},
"CreationPolicy" : <span>{</span>
  "ResourceSignal" : <span>{</span>
    "Count" : <span>{</span> "Ref" : "ResourceSignalsOnCreate"},
    "Timeout" : "PT10M"
  },
  "AutoScalingCreationPolicy" : <span>{</span>
    "MinSuccessfulInstancesPercent" : <span>{</span> "Ref" : "MinSuccessfulPercentParameter" }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="attribute-updatepolicy-example-2.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">UpdatePolicy:
  AutoScalingReplacingUpdate:
    WillReplace: true
CreationPolicy:
  ResourceSignal:
    Count: !Ref 'ResourceSignalsOnCreate'
    Timeout: PT10M
  AutoScalingCreationPolicy:
    MinSuccessfulInstancesPercent: !Ref 'MinSuccessfulPercentParameter'</code></pre>
      </div>
     
     
      <h3 id="aws-attribute-updatepolicy-cfn-init-metadata">Maintain availability when
          updating the metadata for the cfn-init helper script</h3>

      <p>When you install software applications on your instances, you might use the <a href="./aws-resource-init.html">AWS::CloudFormation::Init</a> metadata key and the <a href="./cfn-init.html">cfn-init</a> helper script to bootstrap the instances in
        your Auto Scaling group. CloudFormation installs the packages, runs the commands, and performs other
        bootstrapping actions described in the metadata.</p>
      <p>When you update only the metadata (for example, when updating a package to another
        version), you can use the <a href="./cfn-hup.html">cfn-hup</a> helper daemon to
        detect and apply the updates. However, the <code class="code">cfn-hup</code> daemon runs independently on
        each instance. If the daemon happens to runs at the same time on all instances, your
        application or service might be unavailable during the update. To guarantee availability,
        you can force a rolling update so that CloudFormation updates your instances one batch at a
        time.</p>
      <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Forcing a rolling update requires CloudFormation to create a new instance and then delete
          the old one. Any information stored on the old instance is lost.</p></div></div>
      <p>To force a rolling update, change the logical ID of the launch configuration resource,
        and then update the stack and any references pointing to the original logic ID (such as the
        associated Auto Scaling group). CloudFormation triggers a rolling update on the Auto Scaling group, replacing
        all instances.</p>
     
     
      <h3 id="aws-attribute-updatepolicy-cfn-init-metadata-original">Original
          template</h3>

      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"LaunchConfig": <span>{</span>
  "Type" : "AWS::AutoScaling::LaunchConfiguration",
  "Metadata" : <span>{</span>
    "Comment" : "Install a simple PHP application",
    "AWS::CloudFormation::Init" : <span>{</span>
    ...
    }
  }
}</code></pre>
     
     
      <h3 id="aws-attribute-updatepolicy-cfn-init-metadata-updated">Updated logical
          ID</h3>

      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"<b>LaunchConfigUpdateRubygemsPkg</b>": <span>{</span>
  "Type" : "AWS::AutoScaling::LaunchConfiguration",
  "Metadata" : <span>{</span>
    "Comment" : "Install a simple PHP application",
    "AWS::CloudFormation::Init" : <span>{</span>
    ...
    }
  }
}</code></pre>
     
     
      <h3 id="aws-resource-lambda-alias-example">Lambda alias update policy</h3>
      <p>The following example specifies the <code class="code">UpdatePolicy</code> attribute for an
          <code class="code">AWS::Lambda::Alias</code> resource. All the details for the deployment are defined
        by the application and deployment group that are passed into the policy.</p>
      <div id="JSON" name="JSON" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-codedeploylambda.json">JSON</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (json)--><code class="json ">"Alias": <span>{</span>
  "Type": "AWS::Lambda::Alias",
  "Properties": <span>{</span>
    "FunctionName": <span>{</span>
      "Ref": "LambdaFunction"
    },
    "FunctionVersion": <span>{</span>
      "Fn::GetAtt": [
        "FunctionVersionTwo",
        "Version"
      ]
    },
    "Name": "MyAlias"
  },
  "UpdatePolicy": <span>{</span>
    "CodeDeployLambdaAliasUpdate": <span>{</span>
      "ApplicationName": <span>{</span>
        "Ref": "CodeDeployApplication"
      },
      "DeploymentGroupName": <span>{</span>
        "Ref": "CodeDeployDeploymentGroup"
      },
      "BeforeAllowTrafficHook": <span>{</span>
        "Ref": "PreHookLambdaFunction"
      },
      "AfterAllowTrafficHook": <span>{</span>
        "Ref": "PreHookLambdaFunction"
      }
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
        <h4 id="aws-attribute-updatepolicy-codedeploylambda-example.yaml">YAML</h4>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli (yaml)--><code class="yaml ">Alias:
  Type: 'AWS::Lambda::Alias'
  Properties:
    FunctionName: !Ref LambdaFunction
    FunctionVersion: !GetAtt FunctionVersionTwo.Version
    Name: MyAlias
  UpdatePolicy:
    CodeDeployLambdaAliasUpdate:
      ApplicationName: !Ref CodeDeployApplication
      DeploymentGroupName: !Ref CodeDeployDeploymentGroup
      BeforeAllowTrafficHook: !Ref PreHookLambdaFunction
      AfterAllowTrafficHook: !Ref PreHookLambdaFunction</code></pre>
      </div>
     
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-resource-init.html">AWS::CloudFormation::Init</div><div id="next" class="next-link" accesskey="n" href="./aws-attribute-updatereplacepolicy.html">UpdateReplacePolicy</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/TemplateReference/aws-attribute-updatepolicy.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>